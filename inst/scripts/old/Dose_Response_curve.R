# https://rstats4ag.org/dose-response-curves.htmllibrary(drc)library(tidyverse)library(dplyr)library(conflicted)source(file = "paths.R")## data base named "pipol" = intensity filePipol <-  readxl::read_xlsx(    path = data_inhouse_sensory_20210329_files_excel_path,    sheet = 4  )head(Pipol)op <-  par(    mfrow = c(1, 2),    mar = c(3.2, 3.2, 2, .5),    mgp = c(2, .7, 0)  ) # make two plots in two columnsplot(  intensity ~ concentration,  data = Pipol,  main = "Original Dose Scale \n Pipol",  cex.main = 0.8)plot(  intensity ~ log(concentration),  data = Pipol,  main = "Logarithmic Dose Scale \n Pipol",  cex.main = 0.8)pipol.m1 <- drm(intensity ~ concentration,  data = Pipol,  fct = LL.4(names = c(    "Slope", "Lower Limit", "Upper Limit", "ED50"  )))summary(pipol.m1)op <- par(  mfrow = c(1, 2),  mar = c(3.2, 3.2, .5, .5),  mgp = c(2, .7, 0))plot(  pipol.m1,  broken = F,  bty = "l",  xlab = "Concentration of Pipol",  ylab = "Odor intensity")abline(h = 5, col = "red")plot(  pipol.m1,  broken = F,  bty = "l",  xlab = "Concentration of Pipol",  ylab = "Odor intensity",  type = "all")abline(h = 5, col = "red")par(op)# Test for lack of fitmodelFit(pipol.m1)# Graphical analysis of residualsop <-  par(    mfrow = c(1, 2),    mar = c(3.2, 3.2, 2, .5),    mgp = c(2, .7, 0)  ) # put two graphs togetherplot(residuals(pipol.m1) ~ fitted(pipol.m1),  main = "Residuals vs Fitted",  cex.main = 0.8)abline(h = 0)qqnorm(residuals(pipol.m1))qqline(residuals(pipol.m1))par(op)##################################### test 3-AFC   #### database named "AFC_Pipol" = 3-AFC fileAFC_Pipol <-  readxl::read_xlsx(    path = data_inhouse_sensory_20210329_files_excel_path,    sheet = 3  )AFC.m1 <- drm(percent ~ concentration,  data = AFC_Pipol,  fct = LL.4(names = c(    "Slope", "Lower Limit", "Upper Limit", "ED50"  )))summary(AFC.m1)plot(  AFC.m1,  broken = F,  bty = "l",  ylim = c(0, 100),  xlab = "Concentration of Pipol",  ylab = "% of correct responses")abline(h = 50, col = "red")