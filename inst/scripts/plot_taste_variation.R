message("This script is made to treat all chasselas together. \n")start <- Sys.time()message("Loading ... \n")message("... packages (and installing them if needed) \n")if (!require(conflicted)) {  install.packages("conflicted")}if (!require(data.table)) {  install.packages("data.table")}if (!require(tidyverse)) {  install.packages("tidyverse")}message("... paths and parameters \n")source(file = "paths.R")source(file = "params.R")source(file = "r/colors.R")message("... functions \n")message("... files ... \n")files <- list.files(  path = analysis_path_04_output,  pattern = "^chasselas.*.tsv",  full.names = TRUE)message("... profile \n")filesList <- lapply(files, read_tsv)deltas <- rbindlist(l = filesList, fill = TRUE, idcol = FALSE) |>  mutate(name = gsub(    pattern = "acide.*",    replacement = "sourness",    x = name  )) |>  mutate(name = gsub(    pattern = "amer.*",    replacement = "bitterness",    x = name  )) |>  mutate(name = gsub(    pattern = "sucré.*",    replacement = "sweetness",    x = name  )) |>  mutate(name = gsub(    pattern = "salé.*",    replacement = "saltiness",    x = name  )) |>  mutate(name = gsub(    pattern = "gras.*",    replacement = "fatness, volume",    x = name  )) |>  mutate(name = gsub(    pattern = "équilibre.*",    replacement = "balance",    x = name  )) |>  mutate(name = gsub(    pattern = "fraicheur.*",    replacement = "freshness",    x = name  )) |>  mutate(name = gsub(    pattern = "longueur.*",    replacement = "persistency",    x = name  )) |>  mutate(name = gsub(    pattern = "salivant.*",    replacement = "mouthwatering",    x = name  ))deltas_avant <- deltas |>  dplyr::filter(grepl(pattern = "avant", x = ProductName))deltas_après <- deltas |>  dplyr::filter(grepl(pattern = "après", x = ProductName))deltas_1 <- deltas_avant |>  dplyr::filter(name == "sourness" |    name == "bitterness" |    name == "sweetness" |    name == "saltiness")deltas_2 <- deltas_avant |>  dplyr::filter(    name == "fatness, volume" |      name == "balance" |      name == "freshness" |      name == "persistency" |      name == "mouthwatering"  )deltas_3 <- deltas_1 |>  dplyr::bind_rows(deltas_2) |>  dplyr::group_by(CJ, name) |>  dplyr::add_count() |>  dplyr::filter(n >= 3) |>  dplyr::ungroup()p <-  ggplot2::ggplot(deltas_3, ggplot2::aes(x = CJ, y = value, colour = CJ)) +  ggplot2::scale_x_discrete() +  ggthemes::scale_color_tableau(palette = "Tableau 20") +  ggplot2::geom_violin() +  ggplot2::geom_jitter(    position = ggplot2::position_jitter(width = .05),    alpha = 0.5  ) +  ggplot2::facet_wrap(facets = ~ as.character(name), nrow = 3) +  ggplot2::theme_minimal() +  ggplot2::ylab(label = "Intensity") +  ggplot2::ylim(c(0, 10)) +  ggplot2::labs(colour = "Panelist") +  ggplot2::theme(    legend.position = "right",    title = element_text(face = "bold"),    strip.text = element_text(face = "bold"),    axis.title.x = ggplot2::element_blank(),    axis.text.x = ggplot2::element_blank(),    axis.ticks = ggplot2::element_blank()  )p